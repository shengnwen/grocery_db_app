<!DOCTYPE html>
<html>
  <head>
    <title>Grocery List App</title>
    <link rel='stylesheet' href='/stylesheets/screen.css' />
  </head>
  <body>
    <div id="layout">
      <h1 id="page-title">Grocery List</h1>

      <% if (storeList.length == 0) { %>
         <div class="item" style="margin-left: auto;margin-right: auto;background-color:#ff8080;".>
            <label>  No results found for your queries. </label>
         </div>
      <% }; %>
      
      
      <div id="storeList-L">
        <form>
          <% storeList.forEach( function ( store ) { %>
            <div class="item" <% if(store.hasAll == false){ %>style="background-color:#ff8080;"<%}%>>
              <input type="radio" name="store" onclick="storeSelect(<%= store.storeID %>);" value="<%= store.storeName %>"
              <% if(store.storeID == initiallySelected){ %> checked="checked" <% } %> > <span style="padding-left:8px;"><%= store.storeName %> </span>
              <span style="position:absolute;right:10px">Total: <%= valuePrepend %><%= store.total %><%= valueAppend %></span><br>
            </div>
          <% }); %>
        </form>
      </div>

      <div id="storeList-R">
        <% storeList.forEach( function ( store ){ %>
          <div id="<%= store.storeID %>" style="display: inline">
            <% missingGroceries.forEach( function ( missing ){ %>
                <% if (missing.storeID == store.storeID) { %>
                    <div class="item" style="background-color:#ff8080;".>
                    <label> Could not find an item for '<%= missing.query %>'. </label>
                    </div>
                <% } %>
            <% }); %>
            <% groceries.forEach( function ( product ){ %>
              <% if (product.storeName == store.storeName) { %>
                <div class="item" onclick="window.open('<%= product.url %>')">
                  <label> <%= product.productName %> </label>
                </div>
              <% } %>
            <% }); %>
          </div>
        <% }); %>
      </div>

      <div id="priceList-R">
        <% storeList.forEach( function ( store ){ %>
          <div id="<%= store.storeID %>Price" style="display: none">
            <% missingGroceries.forEach( function ( missing ){ %>
                <% if (missing.storeID == store.storeID) { %>
                    <div class="item" style="visibility:hidden;">
                    </div>
                <% } %>
            <% }); %>
            <% groceries.forEach( function ( product ){ %>
              <% if (product.storeName == store.storeName) { %>
                <div class="item">
                  <label> <%= valuePrepend %><%= product.price %><%= valueAppend %> </label>
                </div>
              <% } %>
            <% }); %>
           <div class="item"><label> Total: <%= valuePrepend %><%= store.total %> <%= valueAppend %></label></div>
          </div>
        <% }); %>
      </div>

    <script>
      function storeSelect(value) {
        document.getElementById(value).style.display = "inline";

        var storeDivs = document.getElementById("storeList-R").childNodes;
        for (var i = 1; i < storeDivs.length; i += 2) {
          if (value != storeDivs[i].id) {
            storeDivs[i].style.display = "none";
          }
        }

        document.getElementById(value + "Price").style.display = "inline";

        var priceDivs = document.getElementById("priceList-R").childNodes;
        for (var i = 1; i < priceDivs.length; i += 2) {
          if (value + "Price" != priceDivs[i].id) {
              priceDivs[i].style.display = "none";
          }
        }

      }

      storeSelect("<%= initiallySelected %>");

    </script>
  </body>
</html>
                                         
